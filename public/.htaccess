RewriteEngine On

# Wiki pretty URLs
# /wiki/article-name -> /modules/wiki/article.php?slug=article-name
RewriteRule ^wiki/([a-zA-Z0-9\-]+)/?$ /modules/wiki/article.php?slug=$1 [L,QSA]

# /wiki/article-name/history -> /modules/wiki/history.php?slug=article-name
RewriteRule ^wiki/([a-zA-Z0-9\-]+)/history/?$ /modules/wiki/history.php?slug=$1 [L,QSA]

# /wiki/article-name/talk -> /modules/wiki/talk.php?slug=article-name
RewriteRule ^wiki/([a-zA-Z0-9\-]+)/talk/?$ /modules/wiki/talk.php?slug=$1 [L,QSA]

# /wiki/article-name/edit -> /pages/wiki/edit_article.php?slug=article-name
RewriteRule ^wiki/([a-zA-Z0-9\-]+)/edit/?$ /pages/wiki/edit_article.php?slug=$1 [L,QSA]

# Special pages
RewriteRule ^wiki/special/([a-zA-Z0-9\-_]+)/?$ /modules/wiki/special/$1.php [L,QSA]

# Category pages
RewriteRule ^wiki/category/([a-zA-Z0-9\-]+)/?$ /modules/wiki/category.php?slug=$1 [L,QSA]

# Default wiki index
RewriteRule ^wiki/?$ /modules/wiki/index.php [L,QSA]

# Handle trailing slashes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/$ /$1 [R=301,L]
