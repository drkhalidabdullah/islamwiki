# IslamWiki Framework - SPA Routing Configuration
# Author: Khalid Abdullah
# Version: 0.0.5
# Date: 2025-01-27
# License: AGPL-3.0

# Enable URL rewriting
RewriteEngine On

# Handle API requests first
RewriteRule ^api/(.*)$ api/index.php [QSA,L]

# Handle Admin API requests
RewriteRule ^admin/api/(.*)$ api/index.php [QSA,L]

# Route all other requests to index.php for React SPA
# This ensures that all routes (like /login, /dashboard, etc.) are handled by React Router
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php [QSA,L]

# Security: Block access to sensitive files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

<FilesMatch "\.(env|log|sql|md|txt|yml|yaml|ini|conf|config)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Security: Block access to vendor and storage directories
<IfModule mod_rewrite.c>
    RewriteRule ^(vendor|storage|config|database|src|tests)/ - [F,L]
</IfModule> 