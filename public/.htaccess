# IslamWiki Framework - Root Apache Configuration
# Author: Khalid Abdullah
# Version: 0.0.5
# Date: 2025-01-27
# License: AGPL-3.0

# Enable URL rewriting
RewriteEngine On

# Handle admin API requests
RewriteRule ^admin/api/(.*)$ api/index.php [QSA,L]

# Handle regular API requests
RewriteRule ^api/(.*)$ api/index.php [QSA,L]

# Route all other requests to the main router (for SPA routing)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php [QSA,L]

# Security: Block access to sensitive files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

<FilesMatch "\.(env|log|sql|md|txt|yml|yaml|ini|conf|config)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Security: Block access to vendor and storage directories
<IfModule mod_rewrite.c>
    RewriteRule ^(vendor|storage|config|database|src|tests)/ - [F,L]
</IfModule> 